<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>BSP430: BSP430 Configuration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BSP430
   &#160;<span id="projectnumber">20141115</span>
   </div>
   <div id="projectbrief">Board Support Package for MSP430 microcontrollers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">BSP430 Configuration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#cfg_consistency">Ensuring Consistency</a></li>
<li class="level1"><a href="#cfg_type">Setting Configuration Options</a><ul><li class="level2"><a href="#cfg_type_flags">Enabling/Disabling Features</a></li>
<li class="level2"><a href="#cfg_type_parameter">Influencing Parametric Options</a></li>
</ul>
</li>
<li class="level1"><a href="#cfg_use">Use of Configuration-Dependent Information</a></li>
<li class="level1"><a href="#cfg_module">Checking for Module Capabilities</a></li>
</ul>
</div>
<div class="textblock"><p>The BSP430 configuration structure is implemented using the standard C preprocessor.</p>
<h1><a class="anchor" id="cfg_consistency"></a>
Ensuring Consistency</h1>
<p>Because the BSP430 infrastructure enables and disables features within separate object files based on the flags presented at the time the source file is compiled, it is critical that all object files in an application have consistent flag definitions.</p>
<p>Each header in BSP430 that does not include another BSP430 file includes the file <a class="el" href="core_8h.html" title="Common header included by all BSP430 leaf headers. ">bsp430/core.h</a>. Subject to <a class="el" href="core_8h.html#ab63537e5c8c1fa94b5d3cbdfc53d9220">configBSP430_CORE_INCLUDE_BSP430_CONFIG_FILE</a>, the first thing this file does is:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;bsp430_config.h&quot;</span></div>
</div><!-- fragment --><p>Unlike all other BSP430 headers, the <code>bsp430_config.h</code> file is not accessed with a path that places it within the BSP430 hierarchy, but is assumed to exist within the application source area. It is in this file that application-specific configuration information should be placed.</p>
<p>The application-specific configuration file should end with:</p>
<div class="fragment"><div class="line"><span class="comment">/* Include platform defaults */</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="bsp430__config_8h.html">bsp430/platform/bsp430_config.h</a>&gt;</span></div>
</div><!-- fragment --><p>This file consults the existing definitions (e.g. <a class="el" href="platform_8h.html#ababc41a3cb834f76137a81137c75f484">BSP430_PLATFORM_EXP430G2</a> or <a class="el" href="platform_8h.html#a33caa59d1913e09742abeefb9d00aad2">BSP430_PLATFORM_CUSTOM</a>) to identify a platform-specific configuration file, which it then includes. In that file any previous requests for specific features, such as <a class="el" href="group__grp__config__functional.html#ga21a5d22e80e4fecc6242b1530632ba85">configBSP430_TIMER_CCACLK</a>, are translated to requests for the underlying peripheral supported on that platform.</p>
<p>Every header that specifies a configuration option or parameter sets a default for that option if no previously encountered header provides an alternative. Not all parameters may be overridden by previous definitions; see <a class="el" href="coding.html#coding_doc_defaulted">@defaulted</a>.</p>
<h1><a class="anchor" id="cfg_type"></a>
Setting Configuration Options</h1>
<p>All overridable feature and parameter values must be provided in a way that ensures all source files see the same value. In most cases, they will be specified in the application <code>bsp430_config.h</code>. For temporary settings to evaluate alternatives they may be set by passing flags to the compiler through the <code>EXT_CPPFLAGS</code> environment or make variable.</p>
<h2><a class="anchor" id="cfg_type_flags"></a>
Enabling/Disabling Features</h2>
<p>If an application wishes to use a peripheral or enable a particular feature such as a <a class="el" href="console_8h.html">serial console</a>, it specifies this by defining a macro to 1 (to enable) or 0 (to disable). The specific peripheral or feature is reflected in the macro name. These macros are annotated with <a class="el" href="coding.html#coding_doc_cppflag">@cppflag</a> to indicate that their values must evaluate to true or false within the context of a C preprocessor expression. In most cases the controlling macro has a lower-case prefix <code>config</code>, further highlighting that it is used for configuration requests and does not indicate that the feature is actually available; see <a class="el" href="bsp430_config.html#cfg_use">Use of Configuration-Dependent Information</a>.</p>
<p>For example, to use the <a class="el" href="layer.html#HPL">HPL</a> interface to digital I/O port 1 it is necessary to define <a class="el" href="group__grp__config__core.html#gae2fc54db8e042a1a968b60deddfe065c">configBSP430_HPL_PORT1</a>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define configBSP430_HPL_PORT1 1</span></div>
</div><!-- fragment --><p>If the <a class="el" href="layer.html#HAL">HAL</a> interface is desired, that must be requested using:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#define configBSP430_HAL_PORT1 1</span></div>
</div><!-- fragment --><p>The HAL interface will always depend on the corresponding HPL interface, but BSP430 will automatically enable the underlying capabilities by default, so you don't need to ask for them explicitly.</p>
<p>Features that are expected to be used commonly such as <a class="el" href="led_8h.html#acee2d05f926c3def423c732439ab3756">configBSP430_LED</a> are enabled by default and may be explicitly disabled if they are unused, but most features including microcontroller peripheral are disabled by default and must be explicitly enabled. Failure to correctly enable a resource that your application depends on can result in either compile-time or link-time errors.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__grp__config__core.html">Configuration of Core Peripheral Resources</a> </dd>
<dd>
<a class="el" href="group__grp__config__functional.html">Configuration of Functional Resources</a></dd></dl>
<h2><a class="anchor" id="cfg_type_parameter"></a>
Influencing Parametric Options</h2>
<p>BSP430 allows control of all values that an application or platform might wish to override, from common ones like <a class="el" href="clock_8h.html#a6ffd3f4fab35b64d0e8ff8d3179d69d9">BSP430_CLOCK_NOMINAL_MCLK_HZ</a> to low-level ones like <a class="el" href="uptime_8h.html#abc74e7198f189c84941a73c523863191">BSP430_UPTIME_DELAY_CCIDX</a> where platform capabilities may require use of the default resource be re-assigned to an application-specific purpose. All such parameters are given default values, and are annotated with <a class="el" href="coding.html#coding_doc_defaulted">@defaulted</a> in their description to highlight that their values may be overridden.</p>
<p>The override mechanism is to simply define a preferred value in the application or platform <code>bsp430_config.h</code>, as:</p>
<div class="fragment"><div class="line"><span class="comment">/* Run this at 20MHz */</span></div>
<div class="line"><span class="preprocessor">#define BSP430_CLOCK_NOMINAL_MCLK_HZ 20000000UL</span></div>
</div><!-- fragment --><h1><a class="anchor" id="cfg_use"></a>
Use of Configuration-Dependent Information</h1>
<p>As a general rule, an option <code>configBSP430_FOO</code> serves as an indication that an application or library function requests that the named feature be made available. It is <b>not</b> a guarantee that the feature could be provided. The documentation for feature request macros (<code>configBSP430_FOO</code>) will always identify the functional macro (<code>BSP430_FOO</code>) that confirms availability of the feature. When this general rule applies, application code should check <code>BSP430_FOO</code> to see whether the request made through <code>configBSP430_FOO</code> could be satisfied.</p>
<p>For example, <a class="el" href="group__grp__config__functional.html#ga21a5d22e80e4fecc6242b1530632ba85">configBSP430_TIMER_CCACLK</a> requests a timer be assigned that supports capturing events when an ACLK-based timer tick occurs, but whether such a timer is available is dependent on whether the platform headers supply a definition for <a class="el" href="group__grp__timer__ccaclk.html#gaa3525a9334a422e17cac7783a0801594">BSP430_TIMER_CCACLK_PERIPH_CPPID</a>. In the documentation, there is an <a class="el" href="coding.html#coding_doc_affects">@affects</a> link from <a class="el" href="group__grp__config__functional.html#ga21a5d22e80e4fecc6242b1530632ba85">configBSP430_TIMER_CCACLK</a> to <a class="el" href="group__grp__timer__ccaclk.html#gaa3525a9334a422e17cac7783a0801594">BSP430_TIMER_CCACLK_PERIPH_CPPID</a> and a <a class="el" href="coding.html#coding_doc_dependency">@dependency</a> link in the reverse direction. (This is a complex example: for technical reasons involving dependency separation <a class="el" href="group__grp__timer__ccaclk.html#gaa3525a9334a422e17cac7783a0801594">BSP430_TIMER_CCACLK_PERIPH_CPPID</a> is provided within the <code>bsp430_config.h</code> hierarchy; it in turn determines the value of <a class="el" href="group__grp__timer__ccaclk.html#gafaa65b8c2e6832c51e73ab8c929af856">BSP430_TIMER_CCACLK</a> which is defined only once &lt;<a class="el" href="timer_8h.html" title="Hardware presentation/abstraction for generic timers (Timer_A/Timer_B) ">bsp430/periph/timer.h</a>&gt; has been included.)</p>
<p>In cases where the affected macro is a C preprocessor symbol it should be checked following the standard for those macros:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="platform_8h.html">bsp430/platform.h</a>&gt;</span></div>
<div class="line"><span class="comment">/* ... */</span></div>
<div class="line"><span class="preprocessor">#if (BSP430_TIMER_CCACLK - 0)</span></div>
<div class="line"><span class="comment">/* The capture/compare-on-aclk feature is available */</span></div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* BSP430_TIMER_CCACLK */</span><span class="preprocessor"></span></div>
</div><!-- fragment --><p><a class="el" href="platform_8h.html" title="Entrypoint for platform-specific capabilities. ">bsp430/platform.h</a> should be the first BSP430-related include file in implementation files, so that both the configuration information obtained through <a class="el" href="core_8h.html" title="Common header included by all BSP430 leaf headers. ">bsp430/core.h</a> and any platform-specific restrictions/overrides are available.</p>
<p>In other cases like <a class="el" href="group__grp__config__core.html#ga5afcb529d6a3d330aa4c79c634ec429e">configBSP430_HPL_PORT7</a> simple use of the feature (viz., reference to <a class="el" href="port_8h.html#a211c90a9d207b2dff496de31f2aa8c4d">BSP430_HPL_PORT7</a>) will produce a compile-time error if the requested feature is not available on the target, so it is generally not necessary to explicitly check for success.</p>
<h1><a class="anchor" id="cfg_module"></a>
Checking for Module Capabilities</h1>
<p>Internally BSP430 checks functional presence macro definitions that are internal to the MCU-specific headers provided by Texas Instruments. In some cases, it may be desirable to detect whether a feature is present without hard-coding checks of those internal macros.</p>
<p>As an example, the Power Management Module is only available on certain 5xx/6xx family MCUs. Rather than attempting to detect that situation and conditionally including <a class="el" href="pmm_8h.html" title="Hardware presentation/abstraction for Power Management Module (PMM). ">bsp430/periph/pmm.h</a>, the module header will do this and define a macro <a class="el" href="pmm_8h.html#af9f6a1ab23247e37c030abdfef888798">BSP430_MODULE_PMM</a> that has a non-zero value only if the module is available. Thus you may use:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="pmm_8h.html">bsp430/periph/pmm.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#if (BSP430_MODULE_PMM - 0)</span></div>
<div class="line"><span class="comment">/* Include declarations related to LPMx.5 mode */</span></div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">/* BSP430_MODULE_PMM */</span><span class="preprocessor"></span></div>
</div><!-- fragment --><p>Copyright 2012-2014, Peter A. Bigot </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 15 2014 11:27:13 for BSP430 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
