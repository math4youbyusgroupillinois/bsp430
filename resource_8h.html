<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>BSP430: include/bsp430/resource.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BSP430
   &#160;<span id="projectnumber">20141115</span>
   </div>
   <div id="projectbrief">Board Support Package for MSP430 microcontrollers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_62ed61ea3473d085a8b2bf70053df4f0.html">include</a></li><li class="navelem"><a class="el" href="dir_7c92f3a74acfd272e55b8e8273858819.html">bsp430</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">resource.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Support for resource management in BSP430.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="core_8h_source.html">bsp430/core.h</a>&gt;</code><br />
</div>
<p><a href="resource_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsBSP430resource.html">sBSP430resource</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsBSP430resourceWaiter.html">sBSP430resourceWaiter</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsBSP430resourceReleaseFlag.html">sBSP430resourceReleaseFlag</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ab682caf5e0d2c8dafbbc4c2d566ee6e1"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structsBSP430resource.html">sBSP430resource</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resource_8h.html#ab682caf5e0d2c8dafbbc4c2d566ee6e1">sBSP430resource</a></td></tr>
<tr class="separator:ab682caf5e0d2c8dafbbc4c2d566ee6e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a529393c11ab0e5f28c23f5295985c470"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structsBSP430resource.html">sBSP430resource</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resource_8h.html#a529393c11ab0e5f28c23f5295985c470">hBSP430resource</a></td></tr>
<tr class="separator:a529393c11ab0e5f28c23f5295985c470"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6283b9a94a7c16c1aa8c28b8f44ce7f8"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resource_8h.html#a6283b9a94a7c16c1aa8c28b8f44ce7f8">iBSP430resourceWaitCallback_ni</a>) (<a class="el" href="resource_8h.html#a529393c11ab0e5f28c23f5295985c470">hBSP430resource</a> resource, struct <a class="el" href="structsBSP430resourceWaiter.html">sBSP430resourceWaiter</a> *waiter)</td></tr>
<tr class="separator:a6283b9a94a7c16c1aa8c28b8f44ce7f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12fd24282454d19b56692f0748ef0417"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structsBSP430resourceWaiter.html">sBSP430resourceWaiter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resource_8h.html#a12fd24282454d19b56692f0748ef0417">sBSP430resourceWaiter</a></td></tr>
<tr class="separator:a12fd24282454d19b56692f0748ef0417"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1808da5825871dde887e70fc601fd555"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="resource_8h.html#ab68f276c7c273f34f7552d584dfeaa37">eBSP430resourceWait</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resource_8h.html#a1808da5825871dde887e70fc601fd555">eBSP430resourceWait</a></td></tr>
<tr class="separator:a1808da5825871dde887e70fc601fd555"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad938baf1ec966ac67d219ba1c42be289"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structsBSP430resourceWaiter.html">sBSP430resourceWaiter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resource_8h.html#ad938baf1ec966ac67d219ba1c42be289">hBSP430resourceWaiter</a></td></tr>
<tr class="separator:ad938baf1ec966ac67d219ba1c42be289"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a252150bb9a417d354b71ab9d83112e68"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structsBSP430resourceReleaseFlag.html">sBSP430resourceReleaseFlag</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resource_8h.html#a252150bb9a417d354b71ab9d83112e68">sBSP430resourceReleaseFlag</a></td></tr>
<tr class="separator:a252150bb9a417d354b71ab9d83112e68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ab68f276c7c273f34f7552d584dfeaa37"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resource_8h.html#ab68f276c7c273f34f7552d584dfeaa37">eBSP430resourceWait</a> { <a class="el" href="resource_8h.html#ab68f276c7c273f34f7552d584dfeaa37aae0fbb756c217ffd8dd7654529772f71">eBSP430resourceWait_NONE</a>, 
<a class="el" href="resource_8h.html#ab68f276c7c273f34f7552d584dfeaa37a20b7ae98ffa57184d699049033a84469">eBSP430resourceWait_FIFO</a>, 
<a class="el" href="resource_8h.html#ab68f276c7c273f34f7552d584dfeaa37acf974269005560f42ded00fdaa73f34c">eBSP430resourceWait_LIFO</a>
 }</td></tr>
<tr class="separator:ab68f276c7c273f34f7552d584dfeaa37"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a33442f88e857bd65d8ddb33f290f9000"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resource_8h.html#a33442f88e857bd65d8ddb33f290f9000">iBSP430resourceClaim_ni</a> (<a class="el" href="resource_8h.html#a529393c11ab0e5f28c23f5295985c470">hBSP430resource</a> resource, void *self, <a class="el" href="resource_8h.html#ab68f276c7c273f34f7552d584dfeaa37">eBSP430resourceWait</a> wait_type, <a class="el" href="resource_8h.html#ad938baf1ec966ac67d219ba1c42be289">hBSP430resourceWaiter</a> waiter)</td></tr>
<tr class="separator:a33442f88e857bd65d8ddb33f290f9000"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c3144ff5dff5a7111d2238fa7923ca6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resource_8h.html#a6c3144ff5dff5a7111d2238fa7923ca6">iBSP430resourceRelease_ni</a> (<a class="el" href="resource_8h.html#a529393c11ab0e5f28c23f5295985c470">hBSP430resource</a> resource, void *self)</td></tr>
<tr class="separator:a6c3144ff5dff5a7111d2238fa7923ca6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b14da80d8ce1b727565eb6aee9ed4c7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resource_8h.html#a8b14da80d8ce1b727565eb6aee9ed4c7">iBSP430resourceCancelWait_ni</a> (<a class="el" href="resource_8h.html#a529393c11ab0e5f28c23f5295985c470">hBSP430resource</a> resource, <a class="el" href="resource_8h.html#ad938baf1ec966ac67d219ba1c42be289">hBSP430resourceWaiter</a> waiter)</td></tr>
<tr class="separator:a8b14da80d8ce1b727565eb6aee9ed4c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae48a6bd844501732b7b88d8bec576942"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="resource_8h.html#ae48a6bd844501732b7b88d8bec576942">iBSP430resourceSetFlagOnRelease</a> (<a class="el" href="resource_8h.html#a529393c11ab0e5f28c23f5295985c470">hBSP430resource</a> resource, <a class="el" href="resource_8h.html#ad938baf1ec966ac67d219ba1c42be289">hBSP430resourceWaiter</a> waiter)</td></tr>
<tr class="separator:ae48a6bd844501732b7b88d8bec576942"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Support for resource management in BSP430. </p>
<p>BSP430 allows a large number of peripheral resources to be shared among subsystems with loose coupling. For example, different source modules can share the interrupt capabilities of a digital port vector without requiring that the interrupt handler be modified. In this case the resource is a pin on the port, and that resource itself is not normally shared among different subsystems.</p>
<p>Experience has indicated that in some cases other peripherals, such as a SPI or I2C bus, may need to perform asynchronous activities using a resource without explicit coordination between systems.</p>
<p>In the original conception of BSP430 this was achieved by making all uses of the resource non-interruptible and run-to-completion. This has proved to be inadequate, especially in cases where the resource may be used for an extended period during which realtime needs require that interrupts be processed promptly.</p>
<p>The <a class="el" href="structsBSP430resource.html">sBSP430resource</a> structure and the API defined in this file support sharing these resources with a mutual exclusion capability similar to semaphores. Atomicity is ensured by disabling interrupts during all manipulation of resource structures. While the resource infrastructure itself will not block, it does provide a mechanism for subsystems to register a callback so they are notified of changes in the resource allocation state.</p>
<dl class="section user"><dt>Homepage</dt><dd><a href="http://github.com/pabigot/bsp430">http://github.com/pabigot/bsp430</a> </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2013-2014, Peter A. Bigot. Licensed under <a href="http://www.opensource.org/licenses/BSD-3-Clause">BSD-3-Clause</a> </dd></dl>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a1808da5825871dde887e70fc601fd555"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="resource_8h.html#ab68f276c7c273f34f7552d584dfeaa37">eBSP430resourceWait</a>  <a class="el" href="resource_8h.html#ab68f276c7c273f34f7552d584dfeaa37">eBSP430resourceWait</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Instructions for how a subsystem may prioritize itself on a list of <a class="el" href="structsBSP430resourceWaiter.html">sBSP430resourceWaiter</a> instances. Used in <a class="el" href="resource_8h.html#a33442f88e857bd65d8ddb33f290f9000">iBSP430resourceClaim_ni()</a>. </p>

</div>
</div>
<a class="anchor" id="a529393c11ab0e5f28c23f5295985c470"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structsBSP430resource.html">sBSP430resource</a>* <a class="el" href="resource_8h.html#a529393c11ab0e5f28c23f5295985c470">hBSP430resource</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A handle for a specific system resource </p>

</div>
</div>
<a class="anchor" id="ad938baf1ec966ac67d219ba1c42be289"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structsBSP430resourceWaiter.html">sBSP430resourceWaiter</a>* <a class="el" href="resource_8h.html#ad938baf1ec966ac67d219ba1c42be289">hBSP430resourceWaiter</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A handle for a structure holding information on a subsystem awaiting a resource </p>

</div>
</div>
<a class="anchor" id="a6283b9a94a7c16c1aa8c28b8f44ce7f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(*  iBSP430resourceWaitCallback_ni) (<a class="el" href="resource_8h.html#a529393c11ab0e5f28c23f5295985c470">hBSP430resource</a> resource, struct <a class="el" href="structsBSP430resourceWaiter.html">sBSP430resourceWaiter</a> *waiter)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The callback to provide a subsystem notification of a change in a resource's state.</p>
<p>This callback is invoked by <a class="el" href="resource_8h.html#a6c3144ff5dff5a7111d2238fa7923ca6">iBSP430resourceRelease_ni()</a> when a resource is released, or if the wait list changes so that a new head may be able to claim the resource (possibly recursively). The API specifically does not guarantee that the resource is in fact available when the callback is invoked.</p>
<p>The callback is explicitly permitted to invoke <a class="el" href="resource_8h.html#a33442f88e857bd65d8ddb33f290f9000">iBSP430resourceClaim_ni()</a> in an attempt to claim the resource. Alternatively, it may set a flag and make the attempt to claim or decision to release at a later time, or invoke <a class="el" href="resource_8h.html#a8b14da80d8ce1b727565eb6aee9ed4c7">iBSP430resourceCancelWait_ni()</a> if it no longer needs to be on the wait queue.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resource</td><td>the resource that has just been released</td></tr>
    <tr><td class="paramname">waiter</td><td>the waiter record provided by the subsystem that wishes to be notified on resource availability.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An integral value consistent with <a class="el" href="callbacks.html#callback_retval">Interrupt Callback Return Values</a> that allows the notified subsystem to affect subsequent execution if the resource was released during an ISR top half. </dd></dl>

</div>
</div>
<a class="anchor" id="ab682caf5e0d2c8dafbbc4c2d566ee6e1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structsBSP430resource.html">sBSP430resource</a>  <a class="el" href="structsBSP430resource.html">sBSP430resource</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Structure holding mutual exclusion data associated with some system resource.</p>
<p>Each resource structure should be initialized to all zeros prior to any possible reference to it. </p>

</div>
</div>
<a class="anchor" id="a252150bb9a417d354b71ab9d83112e68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structsBSP430resourceReleaseFlag.html">sBSP430resourceReleaseFlag</a>  <a class="el" href="structsBSP430resourceReleaseFlag.html">sBSP430resourceReleaseFlag</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A record identifying a flag and the bits in it that should be set when a resource is released.</p>
<p>A pointer to an instance of this type should be stored in the <a class="el" href="structsBSP430resourceWaiter.html#a8a444c269cd003bb7c24ac3d08e5a658">sBSP430resourceWaiter::context</a> field of a waiter that uses <a class="el" href="resource_8h.html#ae48a6bd844501732b7b88d8bec576942">iBSP430resourceSetFlagOnRelease()</a> as its <em><a class="el" href="structsBSP430resourceWaiter.html#a1aa460ddaf220af1f79462ccf47a5387">sBSP430resourceWaiter::callback_ni</a></em>. </p>

</div>
</div>
<a class="anchor" id="a12fd24282454d19b56692f0748ef0417"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structsBSP430resourceWaiter.html">sBSP430resourceWaiter</a>  <a class="el" href="structsBSP430resourceWaiter.html">sBSP430resourceWaiter</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Structure registering a subsystem that needs to be informed when a resource is released. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ab68f276c7c273f34f7552d584dfeaa37"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="resource_8h.html#ab68f276c7c273f34f7552d584dfeaa37">eBSP430resourceWait</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Instructions for how a subsystem may prioritize itself on a list of <a class="el" href="structsBSP430resourceWaiter.html">sBSP430resourceWaiter</a> instances. Used in <a class="el" href="resource_8h.html#a33442f88e857bd65d8ddb33f290f9000">iBSP430resourceClaim_ni()</a>. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a class="anchor" id="ab68f276c7c273f34f7552d584dfeaa37aae0fbb756c217ffd8dd7654529772f71"></a>eBSP430resourceWait_NONE&#160;</td><td class="fielddoc">
<p>Indicate that <a class="el" href="resource_8h.html#a33442f88e857bd65d8ddb33f290f9000">iBSP430resourceClaim_ni()</a> does not register a waiter if the resource is already in use </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ab68f276c7c273f34f7552d584dfeaa37a20b7ae98ffa57184d699049033a84469"></a>eBSP430resourceWait_FIFO&#160;</td><td class="fielddoc">
<p>Indicate that <a class="el" href="resource_8h.html#a33442f88e857bd65d8ddb33f290f9000">iBSP430resourceClaim_ni()</a> should add this waiter to the end of the queue if the resource is already in use.</p>
<p>If the waiter is already in the queue its position is not changed. </p>
</td></tr>
<tr><td class="fieldname"><a class="anchor" id="ab68f276c7c273f34f7552d584dfeaa37acf974269005560f42ded00fdaa73f34c"></a>eBSP430resourceWait_LIFO&#160;</td><td class="fielddoc">
<p>Indicate that <a class="el" href="resource_8h.html#a33442f88e857bd65d8ddb33f290f9000">iBSP430resourceClaim_ni()</a> should add this waiter to the beginning of the queue if the resource is already in use.</p>
<p>If the waiter is already in the queue its position is not changed. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a8b14da80d8ce1b727565eb6aee9ed4c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iBSP430resourceCancelWait_ni </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="resource_8h.html#a529393c11ab0e5f28c23f5295985c470">hBSP430resource</a>&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="resource_8h.html#ad938baf1ec966ac67d219ba1c42be289">hBSP430resourceWaiter</a>&#160;</td>
          <td class="paramname"><em>waiter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Remove <code>waiter</code> from the queue for <code>resource</code>.</p>
<p>This function is used when a subsystem that has requested a resource determines that the resource is no longer needed.</p>
<p>If <code>waiter</code> was at the head of the resource's wait queue the callback of the new head of the queue (if any) will be recursively invoked and its return value used as the return value of this function. This ensures that invocation of this function from within an <a class="el" href="resource_8h.html#a6283b9a94a7c16c1aa8c28b8f44ce7f8">iBSP430resourceWaitCallback_ni()</a> will not cause the notification of availability to be lost, and that recursive resource allocation is satisfied as soon as possible.</p>
<dl class="section note"><dt>Note</dt><dd>There is no validation (and no penalty) if <code>waiter</code> is not on the <code>resource</code> wait list.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resource</td><td>a pointer to the structure associated with a shared resource</td></tr>
    <tr><td class="paramname">waiter</td><td>the wait handle used for notification when the resource becomes available.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The return value from the callback to the new head if that was invoked, or zero. </dd></dl>

</div>
</div>
<a class="anchor" id="a33442f88e857bd65d8ddb33f290f9000"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iBSP430resourceClaim_ni </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="resource_8h.html#a529393c11ab0e5f28c23f5295985c470">hBSP430resource</a>&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="resource_8h.html#ab68f276c7c273f34f7552d584dfeaa37">eBSP430resourceWait</a>&#160;</td>
          <td class="paramname"><em>wait_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="resource_8h.html#ad938baf1ec966ac67d219ba1c42be289">hBSP430resourceWaiter</a>&#160;</td>
          <td class="paramname"><em>waiter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Attempt to claim the right to use a resource.</p>
<p>This is a non-blocking call. The caller is granted the right to use the resource if the resource is not in use, or if the <a class="el" href="structsBSP430resource.html#a216763bbb1371c8db5b63ff1022dcb42">holder</a> of the resource is <code>self</code>. In either case, <a class="el" href="structsBSP430resource.html#aff276d869934df60446c92903eee4d89">sBSP430resource::count</a> is incremented, and 0 is returned.</p>
<p>If the resource is in use by another holder, the attempt to claim fails and -1 is returned.</p>
<p>If the resource claim succeeds, any appearance of <code>waiter</code> is removed from the resource <a class="el" href="structsBSP430resource.html#a9ccef47a0649795374246224f9106c00">sBSP430resource::waiter</a> list prior to return. If the resource claim fails and <code>waiter</code> is not a null pointer, <code>waiter</code> is added into the <a class="el" href="structsBSP430resource.html#a9ccef47a0649795374246224f9106c00">sBSP430resource::waiter</a> waiter list in the order specified by <code>wait_type</code> if absent from that list, and left in its original position if already present in the list.</p>
<dl class="section note"><dt>Note</dt><dd>BSP430 does not aspire to be an RTOS, and the weak prioritization supported by <code>wait_type</code> is not affected by repeated failed resource claim attempts. If necessary the waiter can be reprioritized by <a class="el" href="resource_8h.html#a8b14da80d8ce1b727565eb6aee9ed4c7">removing it</a> and making another attempt to claim the resource.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resource</td><td>a pointer to the structure associated with a resource that may be shared among subsystems.</td></tr>
    <tr><td class="paramname">self</td><td>an identifier unique to the requesting subsystem. If this is a null pointer, attempts to claim the resource will succeed only if it is not in use; in that situation, in a successful claim the holder is set to be the resource itself. In many cases, <code>waiter</code> is an appropriate unique value to use for <code>self</code> when a recursive mutex is required, and <code>NULL</code> when a non-recursive mutex is required.</td></tr>
    <tr><td class="paramname">wait_type</td><td>How <code>waiter</code> should be prioritized relative to any other waiters that may already be in the queue</td></tr>
    <tr><td class="paramname">waiter</td><td>An optional structure that can be used to notify the calling subsystem when the resource may be available. A null pointer is used when the caller will retry as needed without a notification.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if the resource was successfully claimed. A negative value if it could not be claimed. </dd></dl>

</div>
</div>
<a class="anchor" id="a6c3144ff5dff5a7111d2238fa7923ca6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iBSP430resourceRelease_ni </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="resource_8h.html#a529393c11ab0e5f28c23f5295985c470">hBSP430resource</a>&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>self</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Release a resource held by a subsystem.</p>
<p>Note that the return value does not indicate whether the resource is still held by this subsystem. If the resource was released, the first waiter on the resource's waiter list (if any) will be notified.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resource</td><td>a pointer to the structure associated with a resource that may be shared among subsystems.</td></tr>
    <tr><td class="paramname">self</td><td>as in <a class="el" href="resource_8h.html#a33442f88e857bd65d8ddb33f290f9000">iBSP430resourceClaim_ni()</a>. If <code>self</code> does not match the <a class="el" href="structsBSP430resource.html#a216763bbb1371c8db5b63ff1022dcb42">holder</a> of the resource the application will spin in place (if <a class="el" href="core_8h.html#af4ecfa4368324d6b1217f79a49f96f81">BSP430_CORE_NDEBUG</a> is zero) or return a negative error code (if <a class="el" href="core_8h.html#af4ecfa4368324d6b1217f79a49f96f81">BSP430_CORE_NDEBUG</a> is nonzero).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A negative value if an error occurs; 0 if the release was successful and there are no subsystems queued to be notified on release; otherwise the result of invoking the <a class="el" href="structsBSP430resourceWaiter.html#a1aa460ddaf220af1f79462ccf47a5387">sBSP430resourceWaiter::callback_ni</a> function of the highest-priority waiter. </dd></dl>

</div>
</div>
<a class="anchor" id="ae48a6bd844501732b7b88d8bec576942"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int iBSP430resourceSetFlagOnRelease </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="resource_8h.html#a529393c11ab0e5f28c23f5295985c470">hBSP430resource</a>&#160;</td>
          <td class="paramname"><em>resource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="resource_8h.html#ad938baf1ec966ac67d219ba1c42be289">hBSP430resourceWaiter</a>&#160;</td>
          <td class="paramname"><em>waiter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function conforming to <a class="el" href="resource_8h.html#a6283b9a94a7c16c1aa8c28b8f44ce7f8">iBSP430resourceWaitCallback_ni</a></p>
<p>In many cases the release of a resource can be communicated to a waiting subsystem by setting a flag in the subsystem's event set and waking the system to process pending events.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">resource</td><td>the resource that is being released</td></tr>
    <tr><td class="paramname">waiter</td><td>the waiter record provided by the subsystem in an unsuccessful call to <a class="el" href="resource_8h.html#a33442f88e857bd65d8ddb33f290f9000">iBSP430resourceClaim_ni()</a>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="periph_8h.html#a54d508be960943682bb59a2d4e7225da">BSP430_HAL_ISR_CALLBACK_EXIT_LPM</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 15 2014 11:27:13 for BSP430 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
